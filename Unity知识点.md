---
title: unity知识点
date: 2017-05-09 18:41:06
tags: 闫帅
---
####模块如下
**UGUI和NGUI**
- - -
**框架：StrangIOC和UFramework**
- - -
**碰撞检测**
- - -
**寻路算法**
- - -
**Shader**
- - -
**粒子**
- - -
**性能优化：CPU、内存**
- - -
**第三方SDK**
- - -
**编辑器扩展**
- - -
**设计模式**
- - - 
- 1.工厂模式
- 2.组合模式

**打包AssetBundle**
- - -
### *Unity基础*
- - -
###### 遇到的比较难的地方
图形算法（内存优化、贴图UV计算）、shader、scrollview拖拉动画、聊天unity和ios端的连接（自己实现的）。
###### Unity3D多线程
多线程好处是可以充分利用多核的优势。Unity本身是没有多线程的，但是c#是有多线程的。

- 仅能从主线程中访问 Unity3D 的组件，对象和 Unity3D 系统调用。
- 多线程始终要注意的都是同步互斥的问题，涉及到锁。

###### Unity3D 的协程和 C# 线程之间的区别是什么？ 
unity的协程模拟多线程，但实际上还是单线程，同一时间只能执行一个，采用的是操作系统时间片轮询的方式。
###### 四元数的作用，四元数对欧拉角的优点？ 
四元数用于表示旋转，相对欧拉角的优点：

- 能进行增量旋转 
- 避免万向锁 
- 给定方位的表达方式有两种，互为负（欧拉角有无数种表达方式） 

###### Prefab 的作用？
预制体，方便实例化和修改参数。
###### Render的作用
用来把物体渲染出来。
###### 如何安全的在不同工程间安全地迁移 asset 数据？三种方法
- 将 Assets 目录和 Library 目录一起迁移。
- 导出包。
- 使用assets Server服务器同步。

###### Mesh Collider
基于网格的碰撞器，更精确，单页更费性能。
###### OnEnable 、 Awake 、 Start的顺序
- Awake：激活的物体，在任何Start()函数之前。
- Start：在Update()函数第一帧之前被调用。
- OnEnable：在Awake之后，Start之前，即物体被启用的时候调用。

###### Update、FixedUpdate、LateUpdate的区别
- Update：没渲染一帧时执行，受渲染的复杂度以及设备性能的影响，时间间隔不固定。
- FixedUpdate：固定时间间隔的更新，可以设置时间间隔。
- LateUpdate：每帧所有的Update之后执行，可以用来做相机跟随。

###### 脚本函数执行顺序
- Awake -> OnEnable -> Start
- Physics(物理相关) 
- Event(事件OnMouseXX)
- Logic(游戏逻辑)
- 渲染可见性()
- GUI

###### material 和 sharedmaterial 的区别？ 
修改 sharedMaterial 将改变所有物体使用这个材质的外观，并且也改变储存在工程里的材质设置。 而material是一份独立拷贝，修改不会影响到其他物体的材质效果。
###### 游戏动画有哪几种，以及其原理
- 关节动画：把角色分成若干独立部分，一个部分对应一个网格模型，部分的动画连接成一个整体的动画，角色比较灵活。
- 单一网络模型动画：也叫关键帧动画，模型整体的动画，可以设置每一帧的状态以及过渡效果，角色动画较真实。
- 骨骼动画：结合以上两种，角色内部由骨骼组成，关节相连，外部添加蒙皮。

###### alpha blend 工作原理
实际显示颜色 = 前景颜色 *Alpha/255 + 背景颜色 *(255-Alpha)/255
###### 光照计算中的diffuse的计算公式
- 实际光照强度 I= 环境光 + 漫反射光 + 镜面高光。
- 环境光： Iambient = 环境光强度 * 环境光颜色。
- 漫反射光：Idiffuse = 漫反射光强度 * 漫反射光颜色 * （法向量·光源方向）。
- 镜面反射光： Ispecular = 镜面光强度 * 镜面光颜色 * (R.V)^n （光的反射向量·观察者方向的n次方，n为光照系数）。

###### lod是什么，优缺点是什么
LOD指细节层次，可以根据显示的层次远近、位置等选用合适的细节表现形式，可以提升渲染性能，缺点就是美术方面麻烦一些，要做不同的细节模型，也增加了一套模型的大小。
###### 模型的渲染流程
模型的网格包含着顶点数据-》通过顶点着色器代码进行顶点着色-》顶点连接生成几何图元-》光栅化将图元转化为对应的像素点-》然后对这些像素进行片段着色-》着色完成后放置在帧缓存中等待渲染。
###### 渲染过程坐标系转换（GPU的工作原理：绘制3D图像到像素点上）
模型-视图-投影-透视-视窗变换：本地坐标-世界坐标-投影坐标-裁剪面坐标-普通窗口坐标-屏幕坐标
###### MipMap是什么？作用？
类似于LOD技术，但是不同的是，LOD针对的是模型资源，而Mipmap针对的纹理贴图资源，根据层次效果选用不同精度的贴图，设置了MipMap后默认生成八个贴图，增大内存，但会优化显存提升性能。
###### 用u3d实现2d游戏，有几种方式？
- GUI
- 摄像机设为 Orthographic ，用面片作为 2d 元素。
- 第三方插件： NGUI 、 2dToolkit

###### u3d中碰撞器和触发器的区别？
碰撞器会有碰撞的效果， IsTrigger = false, 可以调用OnCollisionEnter/Stay/Exit 函数；触发器没有碰撞效果， isTrigger = true, 可以调用 OnTriggerEnter/stay/exit 函数。
###### 几种施加力的方式
rigidbody 的成员函数：AddForce/AddForceAtPosition
###### 什么叫做链条关节
保持两个物体在一个固定距离内部相互移动而不产生作用力，但是达到固定距离后就会产生拉力，有点像弹簧。
###### 旋转的方式
- 自转：Rotate
- 绕点旋转：RotateAround

###### 什么是烘焙
讲场景中设置好的效果烘焙到场景贴图中，静态的，不需要再实时计算这部分光的效果，提升性能。
###### Clear Flags 清除标记
- Skybox 天空盒
- Solid Color 纯色： 屏幕上的任何空的部分将显示当前相机的背景颜色。
- Depth Only 仅深度：多个相机时，使用深度优先覆盖，相机深度值大的覆盖值小的，可以保证在其上显示。
- Don't Clear 不清除：每一帧的绘制会叠加。

###### 什么是渲染管道？
显示器上为了显示出图像而经过的一系列变换处理，包括坐标变换、着色器处理、光栅化等。
###### 如何优化内存？
最占内存的就是资源，包括网格数量、纹理的大小格式、动画、材质shader、字体、文本等，主要的就是纹理和网格的占用。

- 纹理：大小尽量是2的幂次方，可以考虑使用图集整合到，格式unity自带多种格式，效率最高的是PVRTC有损压缩，但是失真比较大一些，效果最好的是RGBA32或ARGB32，具体要看效果平衡，android上考虑ETC格式。
- 考虑关闭MipMap。
- 降低模型的片面数，降低模型的骨骼数量，降低贴图的大小。
- AB加载的文件即时释放，使用Resources.UnloadUnusedAssets。
- 使用光照贴图，LOD等。
- 裁剪合并粒子系统。

###### Resources.Load和AssetBundle
- Resources.Load只能加载Resources文件夹下的资源，主要是内置包资源。
- AssetBundle需要先打包成ab文件，可以从本地加载，但主要是从网络加载，可以做增量更新。

###### 什么是协同程序？有什么用？
主线程运行之外另开一个任务运行。执行过程中,可以在任意位置使用yield语句控制何时恢复协同程序向下执行，缺点可能会堵塞。
##### 用过的插件
DoTween、ShaderForge、EasyTouch、PoolManager、ShareSDK
###### Unity中，照相机的Clipping Planes的作用是什么
剪裁平面，从相机到开始渲染和停止渲染之间的距离。
###### 如何让GameObject在LoadLevel后不被卸载掉？
DontDestroyOnLoad。
###### 静态批处理和动态批处理
- 动态批处理：unity自动完成的，拥有相同材质和尺寸的物体会批处理合并到一次Draw Call中。
- 静态批处理：要求物体是静态的，且拥有相同材质的所有物体，进行合并。

###### Unity的时间系统
有三部分组成：EventSystem负责管理，BaseInputModule负责监听输入，BaseRaycaster负责检测目标对象，具体的目标对象负责接收事件并处理。
###### 在编辑场景时将GameObject设置为Static有何作用？
可以实现遮挡剔除。
###### 有A和B两组物体，有什么办法能够保证A组物体永远比B组物体先渲染？
通过shader里面的渲染队列来设置优先级。
###### 将图片的TextureType选项分别选为““Texture”和“Sprite”有什么区别
Sprite作为UI精灵使用，Texture作用模型贴图使用。Sprite需要2的整次幂，打包图片省资源。
###### 什么是DrawCall？DrawCall高了又什么影响？如何降低DrawCall？
通知GPU渲染一次的过程称为一次Draw Call。越大越耗性能。可以通过动态、静态批处理或调整shader，减少渲染通道。
###### 水面倒影的渲染原理
对水面的贴图纹理进行扰动，可以使用shader在像素级别作扰动，需要的顶点少，速度快。
###### FSM有限状态机实现原理
每个对象都维护自己的状态机，状态机的状态改变，靠状态触发器来调度。
###### 你对资源加载有什么看法
如果一个资源比较大，那么最好提前加载好，比如登录的时候就加载好，一些频繁使用的模块可以考虑缓存一下，是在不行的话再用转圈等待的方式。




### *C#基础*
- - -
###### C#和C++区别
类型安全，支持垃圾回收(无用内存回收),内存自动管理，没有指针，完全面向对象。
###### 值类型与引用类型的区别: 
- 值类型通常是基本类型，存储数据值；引用存储的是数据的指针或引用。
- 值类型存取速度快，引用类型存取速度慢。
- 值在栈中，由系统自动释放；引用在堆上，需要手动管理或通过GC释放。
- 值类型在声明的时候就已经分配了内存并初始化了；引用类型需要手动分配。

###### C# 中所有引用类型的基类是什么
**System.Object**
###### ArrayList 和 List 的主要区别
ArrayList：需要拆装箱，耗性能且类型转换不安全。
List 是泛型接口，声明时需要固定类型。
###### GC（垃圾回收）产生的原因，并描述如何避免
GC是用来回收堆上的内存。避免的方式就是减少堆内存的分配：减少new的次数；有些变量可以改用全局变量或静态变量。
###### 关键字 Sealed 用在类声明和函数声明时的作用
Sealed不允许继承，不允许重写。
###### private ， public ， protected ， internal 的区别
internal：只能在包含该类的程序集中访问该类。
###### .Net 与 Mono 的关系？
都是运行平台，.Net是window相关的，而Mono是跨平台的。
###### 矩阵相乘的意义
线性变换：旋转、缩放、平移、投影，速度比较快，是计算机内部的变换方式。
###### 在不同分辨率下保持 UI 的一致性 
根据屏幕的宽高比跟原来的预设的屏幕分辨率作比较，用此结果修改摄像机的size。
###### String和stringBuilder 
String是常量，不支持字符串修改，会创建新的内存，stringBuilder是变量，对于频繁修改字符串可以节省内存。
###### ref参数和out参数是什么？有什么区别？
有点类似指针变量。ref参数传入前必须初始化，常用来修改；out不必预先初始化，但需要在函数内初始化，常用来做多返回值。
###### 委托
委托是一种引用类型，是对方法的一种抽象。
###### 序列化
把对象转换为容易传输的格式的过程，或者用于存储减少大小。
###### 事件
对消息的封装处理机制，我的理解是可以对委托的操作进行监听。
###### 能用foreach遍历访问的对象需要实现接口或声明___方法的类型
IEnumerable；GetEnumerator。注意foreach是只读的，不能一边遍历一边修改。




















































